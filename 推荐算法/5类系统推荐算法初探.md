# 5类系统推荐算法

## 简介

推荐算法大致可以分为以下几类：

- 基于流行度的算法
- 协同过滤算法
- 基于内容的算法
- 基于模型的算法
- 混合算法

## 基于流行度的算法

基于流行度的算法非常简单粗暴，类似于各大新闻、微博热榜等，根据PV、UV、日均PV或分享率等数据来按某种热度排序来推荐给用户。

这种算法的优点是简单，适用于刚注册的新用户。

基于这种算法也可做一些优化，比如加入用户分群的流行度排序，例如把热榜上的体育内容优先推荐给体育迷，把政要热文推给热爱谈论政治的用户。

## 协同过滤算法（CF）

协同过滤算法(Collaborative Filtering, CF)，包括基于用户的CF(User-based CF)和基于物品的CF(Item-based CF)。

### User-based CF 原理

- 分析各个用户对item的评价（通过浏览记录、购买记录等）；
- 依据用户对item的评价计算得出所有用户之间的相似度；
- 选出与当前用户最相似的N个用户；
- 将这N个用户评价最高并且当前用户又没有浏览过的item推荐给当前用户。

![img](http://img.mp.itc.cn/upload/20160527/643c952cd50e47cdb336f178ba7dd896_th.jpg)

大致的计算流程如下：

首先我们根据网站的记录计算出一个用户与item的关联矩阵，如下：

![img](http://img.mp.itc.cn/upload/20160527/853292cf1c174abb97a9fd72ded84aa2.png)

图中，行是不同的用户，列是所有物品，(x, y)的值则是x用户对y物品的评分（喜好程度）。我们可以把每一行视为一个用户对物品偏好的向量，然后计算每两个用户之间的向量距离，这里我们用余弦相似度来算：

![img](http://img.mp.itc.cn/upload/20160527/f21d869e650f4a21b1a3f7691ce5941e.png)

然后得出用户向量之间相似度如下，其中值越接近1表示这两个用户越相似。

最后，我们要为用户1推荐物品，则找出与用户1相似度最高的N名用户（设N=2）评价的物品，去掉用户1评价过的物品，则是推荐结果。

### Item-based CF原理

- 分析各个用户对item的浏览记录。
- 依据浏览记录分析得出所有item之间的相似度；
- 对于当前用户评价高的item，找出与之相似度最高的N个item；
- 将这N个item推荐给用户。

![img](http://img.mp.itc.cn/upload/20160527/765df80e9b2b450e8e7c13ba190165a6_th.jpg)

Item-based CF，关联矩阵变为了item和item之间的关系，若用户同时浏览过item1和item2，则(1,1)的值为1，最后计算出所有item之间的关联关系如下：

![img](http://img.mp.itc.cn/upload/20160527/2e26dec6e3bf47d1a399bef1b4029917.png)

#### 协同算法的问题：

- 依赖于准确的用户评分；
- 在计算的过程中，那些大热的物品会有更大的几率被推荐给用户；
- 冷启动问题。当有一名新用户或者新物品进入系统时，推荐将无从依据；
- 在一些item生存周期短（如新闻、广告）的系统中，由于更新速度快，大量item不会有用户评分，造成评分矩阵稀疏，不利于这些内容的推荐。

对于矩阵稀疏的问题，有很多方法来改进CF算法。比如通过矩阵因子分解（如LFM），我们可以把一个nm的矩阵分解为一个nk的矩阵乘以一个k*m的矩阵。

这里的k可以是用户的特征、兴趣爱好与物品属性的一些联系，通过因子分解，可以找到用户和物品之间的一些潜在关联，从而填补之前矩阵中的缺失值。

## 基于内容的算法

基于内容的推荐算法能够很好地解决冷启动问题，不会被局限于热度的限制，因为它是直接基于内容匹配的，而与浏览记录无关。然而它也会存在一些弊端，比如过度专业化(over-specialisation)的问题。这种方法会一直推荐给用户内容密切关联的item，而失去了推荐内容的多样性。

### 介绍

协同算法，无论的user-base还是item-base都无法解决的情况：

假如我是个《指环王》的忠实读者，我买过一本《双塔奇兵》，这时库里新进了第三部：《王者归来》，那么显然我会很感兴趣。

> 因为是新来的书，所以用user-base的话，其他相同兴趣的用户，没有观看，可能无法推荐。
>
> item-base的话，因为基于该用户从前的浏览记录，可能发现该书用户会喜欢，但是因为热度不够，可能优先级不高。
>
> ​																				——Mark

于是基于内容的推荐算法呼之欲出。

一个用户，分析用户的行为，提取出数个关键字：

一条新闻，分析新闻的文本内容，提取出数个关键字：

![img](http://img.mp.itc.cn/upload/20160527/365ea6ccd8bb4d7e9ee7f61e0d1a1b91_th.png)

将这些关键字作为属性，把用户和新闻分解成向量：

> user，tags1有--1；item，tags无--0。
>
> 5个标签。所以是一个5维的向量。

![img](http://img.mp.itc.cn/upload/20160527/497dd7832f3344f2b8dc0d0cf2fe02ff_th.png)

计算向量距离，便可以得出该用户和新闻的相似度了。



**问题：**

用户关键词：英超。

新闻关键词：体育、足球、英超。

### 词权

匹配前两个词都不如直接匹配英超来得准确。系统该如何体现出关键词的这种“重要性”呢？这时我们便可以引入词权的概念。

在大量的语料库中通过计算（比如典型的TF-IDF算法），我们可以算出新闻中每一个关键词的权重，在计算相似度时引入这个权重的影响，就可以达到更精确的效果。

sim(user, item) = 文本相似度(user, item) * 词权

**问题：**

用户关键词：足球。

新闻的关键词：德甲、英超。

按照上面的文本匹配方法显然无法将他们关联到一起。在此，我们可以引用话题聚类：

### 话题聚类

利用word2vec一类工具，可以将文本的关键词聚类，然后根据topic将文本向量化。

如可以将德甲、英超、西甲聚类到“足球”的topic下，将lv、Gucci聚类到“奢侈品”topic下，再根据topic为文本内容与用户作相似度计算。

![img](http://img.mp.itc.cn/upload/20160527/97260264350d4776ba279d5988c5f09f_th.png)

## 基于模型的算法

机器学习，举例：Logistics回归预测。

表中的行是一种物品，x1~xn是影响用户行为的各种特征属性，如用户年龄段、性别、地域、物品的价格、类别等等，y则是用户对于该物品的喜好程度，可以是购买记录、浏览、收藏等等。通过大量这类的数据，我们可以回归拟合出一个函数，计算出x1~xn对应的系数，这即是各特征属性对应的权重，权重值越大则表明该属性对于用户选择商品越重要。

　　在拟合函数的时候我们会想到，单一的某种属性和另一种属性可能并不存在强关联。比如，年龄与购买护肤品这个行为并不呈强关联，性别与购买护肤品也不强关联，但当我们把年龄与性别综合在一起考虑时，它们便和购买行为产生了强关联。比如（我只是比如），20~30岁的女性用户更倾向于购买护肤品，这就叫交叉属性。通过反复测试和经验，我们可以调整特征属性的组合，拟合出最准确的回归函数。

## 混合算法

## 用户画像

　用户画像是最近经常被提及的一个名词，引入用户画像可以为推荐系统带来很多改进的余地，比如：

1. 打通公司各大业务平台，通过获取其他平台的用户数据，彻底解决冷启动问题；
2. 在不同设备上同步用户数据，包括QQID、设备号、手机号等；
3. 丰富用户的人口属性，包括年龄、职业、地域等；
4. 更完善的用户兴趣状态，方便生成用户标签和匹配内容。



